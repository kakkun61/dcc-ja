# S-9.2.1 デジタルコマンドコントロールの拡張パケット形式

[原文](https://www.nmra.org/sites/default/files/s-9.2.1_2012_07.pdf)

原文版：July 2012

The NMRA Communications Standard for Digital Communications (S-9.2) provides a minimal, basic packet format required for interoperability. This STANDARD provides Extended Packet Formats that provide the framework to enable realistic operations to occur. These formats adhere to the general packet format as defined in S-9.2. While the baseline packet has a length of 3 data bytes separated by a "0" bit, a packet using the extended packet format definition may have a length of between 3 and 6 data bytes each separated by a "0" bit.

### 形式定義

Within this Standard, bits within the address and data bytes will be defined using the following abbreviations. Individual bytes within a specific packet format are separated by spaces. Bytes which are within square [] brackets can occur one or more times as necessary. Bits are numbered from right to left with bit 0 (the right most bit) being the least significant bit (LSB) and bit 7 (the left most bit) being the most significant bit (MSB).

記号 | 説明
:---:|---
`A` | アドレスビット
`0` | 「0」値ビット
`1` | 「1」値ビット
`U` | 未既定ビット
`B` | ビット位置・アドレス
`C` | 命令種別
`F` | 命令実装判別子
`L` | 下位バイナリー状態制御アドレス
`H` | 上位バイナリー状態制御アドレス
`S` | デコーダー副アドレスビット
`V` | CV アドレスビット
`D` | データ
`X` | Signal Head Aspect Data Bit
`E` | エラー検出ビット

## A：アドレス分割

The first data byte of an Extended Packet Format packet contains the primary address. In order to allow for different types of decoders this primary address is subdivided into fixed partitions as follows.

アドレス | 説明
:---:|---
`00000000`（`0`） | ブロードキャストアドレス
`00000001` ～ `01111111`（`1` ～ `127`） | 7ビットアドレス多機能デコーダー
`10000001` ～ `10111111`（`128` ～ `191`） | 9ビットアドレス基本アクセサリーデコーダー<br>11ビットアドレス拡張アクセサリーデコーダー
`11000001` ～ `11100111`（`192` ～ `231`） | 14ビットアドレス多機能デコーダー
`11101000` ～ `11111110`（`232` ～ `254`） | 将来の使用のため予約
`11111111`（`255`） | アイドルパケット

## B：多機能デジタルデコーダー用ブロードキャストコマンド

The format for this packet is:

```
前文 0 00000000 0 命令バイト 0 EEEEEEEE 1
```

## C：多機能デジタルデコーダー用命令パケット

The formats for these packets are:

```
前文 0 [ AAAAAAAA ] 0 命令バイト 0 EEEEEEEE 1
```

### デコーダー制御と構成制御命令（000）

#### デコーダー制御（0000）

This instruction has the format of

```
命令バイト = 0000CCCF, or 命令バイト = 0000CCCF DDDDDDDD
```

#### 構成制御（0001）

### 発展的制御命令（001）

### 速度命令と方向命令（010・011）

### 機能群1命令（100）<sup>※4</sup>

### 機能群2命令（101）<sup>※5</sup>

### 機能拡張命令（110）

### CV 読み書き命令（111）

#### CV 読み書き応答

#### CV 読み書き手順（短式）

#### CV 読み書き手順（長式）

## D：アクセサリーデジタルデコーダーパケット形式

### 基本アクセサリーデコーダーパケット形式

The format for packets intended for Accessory Digital Decoders is:

```
前文 0 10AAAAAA 0 1AAACDDD 0 EEEEEEEE 1
```

### 拡張アクセサリーデコーダー制御パケット形式

The Extended Accessory Decoder Control Packet is included for the purpose of transmitting aspect control to signal decoders or data bytes to more complex accessory decoders. Each signal head can display one aspect at a time.

```
前文 0 10AAAAAA 0 0AAA0AA1 0 000XXXXX 0 EEEEEEEE 1
```

### アクセサリーデコーダー用ブロードキャストコマンド

#### 基本アクセサリーデコーダー用ブロードキャストコマンド

The format for the broadcast instruction is:

```
前文 0 10111111 0 1000CDDD 0 EEEEEEEE 1
```

#### 拡張アクセサリーデコーダー用ブロードキャストコマンド

The format for the broadcast instruction is:

```
前文 0 10111111 0 00000111 0 000XXXXX 0 EEEEEEEE 1
```

### アクセサリーデコーダー CV 読み書き手順

## E：制御モード応答

## 付録 A

## アクセサリーデコーダー CV 読み書き手順<sup>※9</sup>
